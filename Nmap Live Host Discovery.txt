Nmap Live Host Discovery :

Nmap : Nmap is used to discover the live hosts, which services are running on these systems in the network.

Nmap scan usually goes into the serveal steps:

1)Enumerate targets
2)Discover live hosts
3)Reverse-DNS lookup
4)Scans ports
5)Detect versions
6)Detect OS
7)Traceroute
8)Script
9)Write output

♦️Network segment : is a group of computers connected using the shared medium.

Subnets with /16, which means that the subnet mask can be written as 255.255.0.0. This subnet can have around 65 thousand hosts.
Subnets with /24, which indicates that the subnet mask can be expressed as 255.255.255.0. This subnet can have around 250 hosts.



♦️ENUMERATING TARGETS :
 
list:   MACHINE_IP scanme.nmap.org example.com will scan 3 IP addresses.
range:  10.11.12.15-20 will scan 6 IP addresses: 10.11.12.15, 10.11.12.16,… and 10.11.12.20.
subnet: MACHINE_IP/30 will scan 4 IP addresses.

you can also provide list of targets : nmap -iL target.txt
you want to check list of hosts the nmap will scan : nmap -sL 10.10.12.13/29

if you want to disable DNS server when scanning use (-n)

Questions : 1)What is the first IP address Nmap would scan if you provided 10.10.12.13/29 as your target?
---> command : nmap -sL 10.10.12.13/29 
in that commmand output , it will show 8 ip address which nmap will scan 
Answer : 10.10.12.8

2)How many IP addresses will Nmap scan if you provide the following range 10.10.0-255.101-125? 
---> command : nmap -sL -n 10.10.0-255.101-125 
in that command output , scan goes like first 10.10.1.101-125 it will scan 25 ip address then it goes to 10.10.2.101-125 its also scan 25 ip address and so on.....
Answer : 6400



♦️DISCOVERING THE LIVE HOSTS :

ARP from Link Layer
ICMP from Network Layer
TCP from Transport Layer
UDP from Transport Layer

ARP send a frame to broadcast address that to specific ip address will respond by providing the mac address
ICMP uses type 8(echo) and type 0(echo reply)
TCP and UDP are transport layer protocol that the scanner send packets to TCP and UDP ports that targert will respond . this technique is efficient when ICMP echo is blocked.


Questions :1️⃣ Send a packet with the following:
From computer1
To computer3
Packet Type: “Ping Request”


1)What is the type of packet that computer1 sent before the ping?
---> ARP Request
2)What is the type of packet that computer1 received before being able to send the ping?
---> ARP Response
3)How many computers responded to the ping request?
--->1

2️⃣Send a packet with the following:
From computer2
To computer5
Packet Type: “Ping Request”

1)What is the name of the first device that responded to the first ARP Request?
---> router
2)What is the name of the first device that responded to the second ARP Request?
---> computer5
3)Send another Ping Request. Did it require new ARP Requests? (Y/N)
---> N



♦️DISCOVERING HOST DISCOVERY USING ARP :

ARP scan is possible when you are in the same subnet.
command : nmap -PR -sn <target/24>

here, -PR indicate that we want only the arp-scan 

arp-scan : arp-scan is very similar to nmap scan it has also customize scan. we use arp-scan --localnet or arp-scan -l . This command will send ARP queries to all valid IP addresses on your local networks.

command  : arp-scan 10.10.210.6/24


♦️DISCOVERING HOST DISCOVERY USING ICMP :

if the firewall blocks the icmp echo requests then use -PE option to discover the live hosts.
command : nmap -PE -sn 10.17.34.213/24

if these option is block then use -PP option.this options is ICMP timestamp request and ICMP address mask request.Nmap uses timestamp request (ICMP Type 13) and checks whether it will get a Timestamp reply (ICMP Type 14).

if the timestamp request is block then we use other options like -PM to discover the live hosts. nmap uses address mask queries (ICMP Type 17) and checks whether it gets an address mask reply (ICMP Type 18). This scan can be enabled with the option -PM

Questions :1)What is the option required to tell Nmap to use ICMP Timestamp to discover live hosts?
--> -PP
2)What is the option required to tell Nmap to use ICMP Address Mask to discover live hosts?
---> -PM
3)What is the option required to tell Nmap to use ICMP Echo to discover live hosts?
--> -PE



♦️NMAP HOST DISCOVERY USING TCP AND UDP :

1️⃣TCP SYN PING : if you want to use SYN ping scan then use -PS option .if we not specify port it use 80 by default
command : nmap -PS -sn -v 10.17.34.213
in that TCP SYN ping a three-way handshake will works 1-SYN 2-SYN&ACK 3-ACK

2️⃣TCP ACK PING : if you want to use TCP ACK ping scan then use -PA option.if we not specify port it use 80 by default
command : nmap -PA -sn 10.17.34.213/24

in this scan a tcp three-way handshake is works 1-ACK 2-RST

3️⃣UDP ping :

contrary to TCP SYN PING , if we send a packet to closed UDP port then we expect that we received ICMP unreachable target error. we option -PU
command : nmap -PU -sn 10.17.34.213/24

Questions :1)Which TCP ping scan does not require a privileged account?
---> TCP SYN PING 

2)Which TCP ping scan requires a privileged account?
---> TCP ACK PING

3)What option do you need to add to Nmap to run a TCP SYN ping scan on the telnet port?
---> -ps23



♦️USING REVERSE-DNS LOOKUP :

by default nmap do reverse-dns lookup to stop it use -n option . -R is used for reverse-dns lookup for all targets which are offline hosts.

Questions : 1)We want Nmap to issue a reverse DNS lookup for all the possibles hosts on a subnet, hoping to get some insights from the names. What option should we add?
---> -R



♦️SUMMARY :

Scan Type 	          Example Command
ARP Scan 	          sudo nmap -PR -sn MACHINE_IP/24
ICMP Echo Scan 	          sudo nmap -PE -sn MACHINE_IP/24
ICMP Timestamp Scan 	  sudo nmap -PP -sn MACHINE_IP/24
ICMP Address Mask Scan 	  sudo nmap -PM -sn MACHINE_IP/24
TCP SYN Ping Scan 	  sudo nmap -PS22,80,443 -sn MACHINE_IP/30
TCP ACK Ping Scan 	  sudo nmap -PA22,80,443 -sn MACHINE_IP/30
UDP Ping Scan 	          sudo nmap -PU53,161,162 -sn MACHINE_IP/30
no DNS lookup                 -n 
reverse-DNS lookup            -R 
for all hosts
host discovery only           -sn 






