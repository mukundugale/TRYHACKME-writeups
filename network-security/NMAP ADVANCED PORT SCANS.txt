üìåNMAP ADVANCED PORT SCANS :
	
‚ô¶Ô∏èINTRODUCTION : 
	We covered nmap live host discovery and basic port scans then we go to nmap advanced port scans
	in that we cover following scan :
	1)Null Scan
        2)FIN Scan
        3)Xmas Scan
        4)Maimon Scan
        5)ACK Scan
        6)Window Scan
        7)Custom Scan
        

‚ô¶Ô∏èTCP Null Scan, FIN Scan, and Xmas Scan :
	
	1Ô∏è‚É£ NULL scan :(-sN)
		In NULL scan, all flag are set to zero means we doesn't set any flag. when use this scan will not trigger any responce where the port is open.
		from nmap perspective,lack of reply in a null scan indicates that either the port is open or a firewall is blocking the packet. 

	 	When we scanning ports we doesn't send flag and we expect that target server response a lack of RST packet that the port is not closed : open|filtered 
	 	use (-sN) option for this scan.
	 	command : sudo nmap -sN <target-ip>	

	2Ô∏è‚É£FIN scan :(-sF)
		In FIN scan,we send a TCP packet(FIN) to target.similar to null scan we doesn't get any response from the target. we expect that target send RST packet
		if the port is closed. we can use (-sF) option 
		command : sudo nmap -sF <target-ip>
		
	3Ô∏è‚É£Xmas scan :(-sX)
		Xmas scan use FIN,PSH and URG packet simultaneously. we can use (-sX) option when using this scan. similarly if target send RST packet then port is closed
		otherwise it will be open|filtered.
		
		
This three scan is efficient when we scanning against the stateless firewall . Stateless firewall is check that SYN flag set to detect the connection attempt. using flag 
combination is better option that firewall deceive packet and reach the system behind it.

Questions :
1)In a null scan, how many flags are set to 1?
---> 0
2)In a FIN scan, how many flags are set to 1?
---> 1
3)In a Xmas scan, how many flags are set to 1?
---> 3
4)Start the VM and load the AttackBox. Once both are ready, open the terminal on the AttackBox and use nmap to launch a FIN scan against the target VM. How many ports appear as open|filtered?
---> 9
5)Repeat your scan launching a null scan against the target VM. How many ports appear as open|filtered?
---> 9


‚ô¶Ô∏èTCP maimon scan :(-sM)
	TCP maimon scan was released in 1996 . in this scan FIN and ACK bits are set. when we use this scan the target send RST packet if the port is closed.use (-sM) option 
	most mordern networks blocks this scan
	command : sudo nmap -sM <target-ip>
	
Questions :
1)In the Maimon scan, how many flags are set?
---> 2


‚ô¶Ô∏èTCP ACK, Window, and Custom Scan :

	1Ô∏è‚É£TCP ACK scan :
		ACK scan will send ACK flag to target . use (-sA) option when scanning. This kind of scan would be helpful if there is a firewall in front of the target.
		In other words, this type of scan is more suitable to discover firewall rule sets and configuration.
		command : sudo nmap -sA <target-ip>
		
	2Ô∏è‚É£TCP windows scan :
		this scan is similar to ACK scan . we send ACK flag to target and we expect that RST packet is returned.you can select this scan using (-sW) option.
		
		command : sudo nmap -sA <target-ip>
		
	3Ô∏è‚É£Custom scan : 
		If you want to experiment with a new TCP flag combination beyond the built-in TCP scan types, you can do so using --scanflags.
		f you want to set SYN, RST, and FIN simultaneously, you can do so using --scanflags RSTSYNFIN. 
		command : mmap --scanflag <target-ip>
		
Questions : 
1)In TCP Window scan, how many flags are set?
---> 1
2)You decided to experiment with a custom TCP scan that has the reset flag set. What would you add after --scanflags? 
---> RST
3)The VM received an update to its firewall ruleset. A new port is now allowed by the firewall. After you make sure that you have terminated the VM from Task 2, start the VM for this task. Launch the AttackBox if you haven't done that already. Once both are ready, open the terminal on the AttackBox and use Nmap to launch an ACK scan against the target VM. How many ports appear unfiltered?
---> 4
4)What is the new port number that appeared? To determine the new port you need to compare the scan results of Task 2 to the ones of this task.
---> 443
5)Is there any service behind the newly discovered port number? (Y/N)
---> N



‚ô¶Ô∏èSpoofing and Decoys :
	In the network setups, you can able to scan target with spoofed-ip and spoofed-mac .but such a scan is only beneficial in a situation where you can guarantee
	to capture the response.If you try to scan a target from some random network using a spoofed IP address, chances are you won‚Äôt have any response routed to you,
	and the scan results could be unreliable.
	command  : nmap -S SPOOF-IP <target-ip> 
	here,all packets are send through spoof-ip address and response get SPOOF-IP
	
	üî¥scanning with spoof-ip has three important steps :
	1)Attacker sends a packet with a spoofed source IP address to the target machine.
        2)Target machine replies to the spoofed IP address as the destination.
        3)Attacker captures the replies to figure out open ports.
        
        
        you expect to specify the network interface using -e and to explicitly disable ping scan -Pn.
        command  : nmap -e <network-interface> -Pn -S spoofed-ip <target-ip>
        When you are on the same subnet as the target machine, you would be able to spoof your MAC address as well. You can specify the source MAC address 
        using --spoof-mac SPOOFED_MAC. this address is spoof only when attacker and target are in same network
        
        Decoy scan : you can spoof ip address with specific and random using decoy scan .use -D option
        command  : nmap -D 10.10.10.17.10.10.30.13,ME <target-ip>
                              OR
                   nmap -D 10.20.13.13,10.33.56,RND,RND,ME <target-ip>
                   in that RND means which will assigned randomly ip address
                   
Questions :
1)What do you need to add to the command sudo nmap MACHINE_IP to make the scan appear as if coming from the source IP address 10.10.10.11 instead of your IP address?
---> -S 10.10.10.11
2)What do you need to add to the command sudo nmap MACHINE_IP to make the scan appear as if coming from the source IP addresses 10.10.20.21 and 10.10.20.28 in addition to your IP address?
---> -D 10.10.20.21,10.10.20.28



‚ô¶Ô∏èFragmented packets :

	Firwall :
	A firewall is a piece of software or hardware that permits packets to pass through or blocks them. It functions based on firewall rules, summarized as blocking
	all traffic with exceptions or allowing all traffic with exceptions. For instance, you might block all traffic to your server except those coming to 
	your web server. A traditional firewall inspects, at least, the IP header and the transport layer header. A more sophisticated firewall would also try to examine
	the data carried by the transport layer.
	
	IDS :
	An intrusion detection system (IDS) inspects network packets for select behavioural patterns or specific content signatures. It raises an alert whenever
	a malicious rule is met. In addition to the IP header and transport layer header, an IDS would inspect the data contents in the transport layer and check
	if it matches any malicious patterns. How can you make it less likely for a traditional firewall/IDS to detect your Nmap activity? It is not easy to 
	answer this; however, depending on the type of firewall/IDS, you might benefit from dividing the packet into smaller packets.

        Fragmented packets :
        nmap has (-f) option for fragmented packets. (-f) option the IP data is divided into 8 bytes or less .addding -f like that -ff will split the data into 16 bytes fragment 
        instead of 8.You can value by using (--mtu)
        command  : nmap -sS -p80 -f <target-ip>
        
Question :
1)If the TCP segment has a size of 64, and -ff option is being used, how many IP fragments will you get?
---> 4



‚ô¶Ô∏èIDLE,ZOMBIE scan  :

	The idle scan, or zombie scan, requires an idle system connected to the network that you can communicate with.You can run an idle scan using
	nmap -sI ZOMBIE_IP 10.201.1.127, where ZOMBIE_IP is the IP address of the idle host (zombie). 
        
        for ex : we have the attacker system probing an idle machine, a multi-function printer. By sending a SYN/ACK, it responds with an RST packet containing
        its newly incremented IP ID. The attacker will send a SYN packet to the TCP port they want to check on the target machine in the next step. 
        However, this packet will use the idle host (zombie) IP address as the source.Then three scnenario will arise
        
        1)attacker send SYN/ACK packet to zombie then it will send RST packet that containing IP ID
        2)if port is open ,we send SYN packet to TCP port on that target as the zombie ip address as the source.then target will send SYN/ACk packet to  zombie ip address
        and then zombie send RST packet ,thus incrementing IP ID
        3)In the third scenario, the target machine does not respond at all due to firewall rules. This lack of response will lead to the same result as with the closed 
        port; the idle host won‚Äôt increase the IP ID.
	For the final step, the attacker sends another SYN/ACK to the idle host. The idle host responds with an RST packet, incrementing the IP ID by one again.
	The attacker needs to compare the IP ID of the RST packet received in the first step with the IP ID of the RST packet received in this third step. 
	If the difference is 1, it means the port on the target machine was closed or filtered. However, if the difference is 2, it means that the port on the target was open.

Questions :
1)You discovered a rarely-used network printer with the IP address 10.10.5.5, and you decide to use it as a zombie in your idle scan. What argument should you add to your Nmap command?
---> -sI 10.10.5.5



‚ô¶Ô∏èGetting more details :
	if you want Nmap to provide more details regarding its reasoning and conclusions.use --reason option.Providing the --reason flag gives us the explicit
	reason why Nmap concluded that the system is up or a particular port is open.
	
Questions :
1)Launch the AttackBox if you haven't done so already. After you make sure that you have terminated the VM from Task 4, start the VM for this task. Wait for it to load completely, then open the terminal on the AttackBox and use Nmap with nmap -sS -F --reason 10.201.1.127 to scan the VM. What is the reason provided for the stated port(s) being open?
---> syn-ack



‚ô¶Ô∏èSUMMARY :


Port Scan Type 	                                      Example Command
TCP Null Scan 	                               sudo nmap -sN 10.201.1.127
TCP FIN Scan 	                               sudo nmap -sF 10.201.1.127
TCP Xmas Scan 	                               sudo nmap -sX 10.201.1.127
TCP Maimon Scan 	                       sudo nmap -sM 10.201.1.127
TCP ACK Scan 	                               sudo nmap -sA 10.201.1.127
TCP Window Scan 	                       sudo nmap -sW 10.201.1.127
Custom TCP Scan 	                       sudo nmap --scanflags URGACKPSHRSTSYNFIN 10.201.1.127
Spoofed Source IP 	                       sudo nmap -S SPOOFED_IP 10.201.1.127
Spoofed MAC Address 	                       --spoof-mac SPOOFED_MAC
Decoy Scan 	                               nmap -D DECOY_IP,ME 10.201.1.127
Idle (Zombie) Scan 	                       sudo nmap -sI ZOMBIE_IP 10.201.1.127
Fragment IP data into 8 bytes 	               -f
Fragment IP data into 16 bytes 	               -ff
--reason                                       explicit reason why Nmap concluded that the system is up or a particular port is open.
-v                                             verbose
-d 	                                       debugging
-dd 	                                       more details for debugging

